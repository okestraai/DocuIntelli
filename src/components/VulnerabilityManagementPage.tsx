import { ArrowLeft } from 'lucide-react';

interface VulnerabilityManagementPageProps {
  onBack: () => void;
}

export function VulnerabilityManagementPage({ onBack }: VulnerabilityManagementPageProps) {
  return (
    <div className="min-h-screen bg-gradient-to-br from-slate-50 via-white to-emerald-50/30">
      <div className="bg-white/80 backdrop-blur-sm border-b border-slate-200 sticky top-0 z-50">
        <div className="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-4">
          <button
            onClick={onBack}
            className="flex items-center gap-2 text-slate-700 hover:text-emerald-600 font-medium transition-colors"
          >
            <ArrowLeft className="h-5 w-5" />
            <span>Back</span>
          </button>
        </div>
      </div>

      <div className="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
        <h1 className="text-3xl sm:text-4xl font-bold text-slate-900 mb-2">Vulnerability Management Policy</h1>
        <p className="text-slate-500 mb-10">Last updated: February 19, 2026</p>

        <div className="prose prose-slate max-w-none space-y-8">
          <section>
            <h2 className="text-xl font-semibold text-slate-900 mb-3">1. Purpose</h2>
            <p className="text-slate-600 leading-relaxed">
              This Vulnerability Management Policy establishes the procedures DocuIntelli AI follows to proactively identify, assess, remediate, and monitor security vulnerabilities across our production infrastructure, application code, dependencies, and development environments. The goal is to minimize the window of exposure to known vulnerabilities and maintain a strong security posture.
            </p>
          </section>

          <section>
            <h2 className="text-xl font-semibold text-slate-900 mb-3">2. Scope</h2>
            <p className="text-slate-600 leading-relaxed">
              This policy covers all assets involved in delivering the DocuIntelli AI service, including but not limited to:
            </p>
            <ul className="list-disc pl-6 text-slate-600 space-y-2">
              <li>Production server instances and containers (Docker, Nginx, Node.js)</li>
              <li>Database systems (Supabase/PostgreSQL)</li>
              <li>Third-party libraries and dependencies (npm packages)</li>
              <li>Cloud infrastructure (Cloudflare, Supabase, Stripe integrations)</li>
              <li>Employee and contractor endpoint devices (laptops, workstations)</li>
              <li>CI/CD pipelines and deployment tooling</li>
            </ul>
          </section>

          <section>
            <h2 className="text-xl font-semibold text-slate-900 mb-3">3. Dependency Vulnerability Scanning</h2>
            <p className="text-slate-600 leading-relaxed mb-3">
              Third-party dependencies are a primary attack vector. We employ the following practices to manage dependency risk:
            </p>
            <ul className="list-disc pl-6 text-slate-600 space-y-2">
              <li><strong>Automated alerts:</strong> GitHub Dependabot is enabled on our repositories to automatically detect and alert on known vulnerabilities in npm dependencies.</li>
              <li><strong>Regular audits:</strong> <code className="bg-slate-100 px-1.5 py-0.5 rounded text-sm">npm audit</code> is run as part of our development workflow to identify vulnerabilities in the dependency tree.</li>
              <li><strong>Patch cadence:</strong> Critical and high-severity vulnerabilities in dependencies are patched within 7 days of disclosure. Medium-severity vulnerabilities are addressed within 30 days. Low-severity issues are tracked and resolved in regular maintenance cycles.</li>
              <li><strong>Lock files:</strong> Package lock files (package-lock.json) are committed to source control to ensure deterministic builds and prevent supply-chain attacks via dependency resolution changes.</li>
            </ul>
          </section>

          <section>
            <h2 className="text-xl font-semibold text-slate-900 mb-3">4. Infrastructure Vulnerability Management</h2>
            <ul className="list-disc pl-6 text-slate-600 space-y-2">
              <li><strong>Container base images:</strong> Production containers use minimal Alpine Linux base images (node:20-alpine). Base images are updated regularly to incorporate security patches.</li>
              <li><strong>Non-root execution:</strong> Application processes run as a non-root user (UID 1001) inside containers, limiting the impact of potential container escapes.</li>
              <li><strong>Image rebuilds:</strong> Production Docker images are rebuilt and redeployed when base image security updates are released or when application dependencies are updated.</li>
              <li><strong>Nginx updates:</strong> The Nginx reverse proxy is kept current with security patches. TLS configuration follows modern best practices (TLS 1.2+ only, forward-secrecy ciphers, disabled session tickets).</li>
              <li><strong>Redis security:</strong> Redis instances are not exposed to the public internet. Access is restricted to the internal Docker network. Memory limits and eviction policies (allkeys-lru) prevent resource exhaustion.</li>
            </ul>
          </section>

          <section>
            <h2 className="text-xl font-semibold text-slate-900 mb-3">5. Application Security Testing</h2>
            <ul className="list-disc pl-6 text-slate-600 space-y-2">
              <li><strong>Code review:</strong> All code changes are reviewed for security implications before merging into production branches.</li>
              <li><strong>Input validation:</strong> All user input is validated at API boundaries. File uploads are restricted by MIME type and size. SQL injection is prevented through parameterized queries (via Supabase client library).</li>
              <li><strong>Authentication testing:</strong> Rate limiting, OTP expiration, and session management are tested for bypass vulnerabilities during development.</li>
              <li><strong>OWASP awareness:</strong> Development follows OWASP Top 10 guidelines, with specific attention to injection, broken authentication, sensitive data exposure, and security misconfiguration.</li>
            </ul>
          </section>

          <section>
            <h2 className="text-xl font-semibold text-slate-900 mb-3">6. Endpoint Security</h2>
            <p className="text-slate-600 leading-relaxed mb-3">
              Employee and contractor devices that access production systems or source code are subject to the following requirements:
            </p>
            <ul className="list-disc pl-6 text-slate-600 space-y-2">
              <li><strong>Operating system updates:</strong> Devices must run current, supported operating systems with automatic security updates enabled.</li>
              <li><strong>Disk encryption:</strong> Full-disk encryption (BitLocker, FileVault, or equivalent) is required on all devices that access production systems.</li>
              <li><strong>Screen lock:</strong> Automatic screen lock after 5 minutes of inactivity is required.</li>
              <li><strong>MFA enforcement:</strong> Access to production dashboards (Supabase, Cloudflare, GitHub, Stripe) requires multi-factor authentication.</li>
            </ul>
          </section>

          <section>
            <h2 className="text-xl font-semibold text-slate-900 mb-3">7. Vulnerability Severity Classification</h2>
            <p className="text-slate-600 leading-relaxed mb-4">
              Vulnerabilities are classified using the Common Vulnerability Scoring System (CVSS) and remediated according to the following SLAs:
            </p>
            <div className="overflow-x-auto">
              <table className="w-full text-sm text-left border border-slate-200 rounded-lg overflow-hidden">
                <thead className="bg-slate-50">
                  <tr>
                    <th className="px-4 py-3 font-semibold text-slate-900 border-b border-slate-200">Severity</th>
                    <th className="px-4 py-3 font-semibold text-slate-900 border-b border-slate-200">CVSS Score</th>
                    <th className="px-4 py-3 font-semibold text-slate-900 border-b border-slate-200">Remediation SLA</th>
                    <th className="px-4 py-3 font-semibold text-slate-900 border-b border-slate-200">Response</th>
                  </tr>
                </thead>
                <tbody className="text-slate-600">
                  <tr className="border-b border-slate-100">
                    <td className="px-4 py-3 font-medium text-red-700">Critical</td>
                    <td className="px-4 py-3">9.0 - 10.0</td>
                    <td className="px-4 py-3">24 hours</td>
                    <td className="px-4 py-3">Immediate triage, emergency patch or mitigation</td>
                  </tr>
                  <tr className="border-b border-slate-100 bg-slate-50/50">
                    <td className="px-4 py-3 font-medium text-orange-700">High</td>
                    <td className="px-4 py-3">7.0 - 8.9</td>
                    <td className="px-4 py-3">7 days</td>
                    <td className="px-4 py-3">Priority patch, deploy within one week</td>
                  </tr>
                  <tr className="border-b border-slate-100">
                    <td className="px-4 py-3 font-medium text-yellow-700">Medium</td>
                    <td className="px-4 py-3">4.0 - 6.9</td>
                    <td className="px-4 py-3">30 days</td>
                    <td className="px-4 py-3">Scheduled patch in next maintenance window</td>
                  </tr>
                  <tr>
                    <td className="px-4 py-3 font-medium text-slate-700">Low</td>
                    <td className="px-4 py-3">0.1 - 3.9</td>
                    <td className="px-4 py-3">90 days</td>
                    <td className="px-4 py-3">Tracked and resolved in regular maintenance</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </section>

          <section>
            <h2 className="text-xl font-semibold text-slate-900 mb-3">8. Responsible Disclosure</h2>
            <p className="text-slate-600 leading-relaxed mb-3">
              We welcome responsible security research. If you discover a vulnerability in DocuIntelli AI:
            </p>
            <ul className="list-disc pl-6 text-slate-600 space-y-2">
              <li>Report it to <a href="mailto:security@docuintelli.com" className="text-emerald-600 hover:text-emerald-700 underline">security@docuintelli.com</a> with sufficient detail to reproduce the issue.</li>
              <li>Allow us reasonable time (up to 90 days) to investigate and remediate before public disclosure.</li>
              <li>Do not access, modify, or delete data belonging to other users during testing.</li>
              <li>We commit to acknowledging receipt within 48 hours and providing status updates during remediation.</li>
            </ul>
          </section>

          <section>
            <h2 className="text-xl font-semibold text-slate-900 mb-3">9. Monitoring & Logging</h2>
            <ul className="list-disc pl-6 text-slate-600 space-y-2">
              <li><strong>Health checks:</strong> Automated health check endpoints monitor the availability of web, database, and cache services.</li>
              <li><strong>Rate limit logging:</strong> Rate limit violations are logged for analysis of potential abuse patterns.</li>
              <li><strong>Cloudflare analytics:</strong> Traffic patterns, blocked threats, and SSL/TLS metrics are monitored via the Cloudflare dashboard.</li>
              <li><strong>Application logs:</strong> Server-side errors and authentication failures are logged for operational awareness and incident investigation.</li>
            </ul>
          </section>

          <section>
            <h2 className="text-xl font-semibold text-slate-900 mb-3">10. Policy Review</h2>
            <p className="text-slate-600 leading-relaxed">
              This policy is reviewed at least annually, or following a significant security event, infrastructure change, or regulatory update. Revisions are approved by the security lead and published on this page with an updated effective date.
            </p>
          </section>

          <section>
            <h2 className="text-xl font-semibold text-slate-900 mb-3">11. Contact</h2>
            <p className="text-slate-600 leading-relaxed">
              For questions about this policy or to report a security concern, contact us at{' '}
              <a href="mailto:security@docuintelli.com" className="text-emerald-600 hover:text-emerald-700 underline">
                security@docuintelli.com
              </a>.
            </p>
          </section>
        </div>
      </div>
    </div>
  );
}
